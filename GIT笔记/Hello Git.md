---
title: Hello Git
date: 2017-11-18 16:56:51
tags:
  - GIT
category: "版本控制"
---

{% cq %}

Pro Git, Second Edition 读书笔记

本人菜鸟，若发现错误，感激指正~~！

{% endcq %}
<!-- more -->
<!-- toc -->

![Git](http://ouq9v8coj.bkt.clouddn.com/images/versionControll.bmp)

# GIT入门(1) 

## 本节必知名词

- VCS : Version Control System 版本控制系统
- CVCS : Centralized Version Control System 集中式版本控制系统
- DVCS : Distributed Version Control System 分布式版本控制系统
- stage/unstage : 暂存/未暂存
- repository : 仓库
- commit : 提交暂存到**本地 **数据库
- push : 使用本地引用更新远程引用，同时发送完成给定引用所需的对象
- pull : 将远程存储库中的更改合并到当前分支中
- check out : 检出项目

## GIT特点

- 速度快
- 设计简洁
- 对非线性开发强有力的支持
- 分布式设计
- 大多数操作都在本地进行


## 集中式版本控制系统和分布式版本控制系统

1. 集中式版本控制系统：

   用一个单一的服务器，保存一个文件的所有修订版本，多个客户端可以从这个中心位置检出文件。常用的CVCS有：SVN、CVS等。

   - 缺点：
     - 当中心服务器停电时，所有人都不能提交更改，也不能检出最新的文件；
     - 当中心服务器崩溃，且无法恢复备份时，整个版本的历史纪录全部丢失。

2. 分布式版本控制系统：

   客户端并非仅仅是检出文件的最新快照，而是对代码仓库进行完整的镜像，每一次检出都是对数据的一次完整备份。一旦服务器发生故障，任何一个客户端都可以使用自己本地镜像来恢复服务器。

{% note info %}

这里说简单点，就是CVCS的版本控制在中央仓库中维护，而DVCS的版本控制在本地维护。

这里我举两个平时工作中的例子，就能够体会到GIT的好处了：

- 随时进行版本控制

  假如项目组使用CVS(一个集中式版本控制系统)来控制代码版本，然后又没有使用分支，所有开发人员都在主干上开发。现在项目组的其他成员正在准备一个大版本更新，而你拿到的是下一个版本的开发需求，两者需要同时进行。因此，为了本次版本上线后不会出问题，是不允许你提交代码到远程服务器的(如果你提交代码，则会加入到本次上线的程序中)。

  对于集中式版本管理，所有的版本控制都在中央仓库，如果不提交代码，是无法进行版本控制的。这样一来，如果需求发生变动，需要将代码回退到某个时间段，这是不可能的，经常导致返工甚至重写(非常蛋疼，别问我咋知道)。

  然而GIT不一样，GIT在本地拥有历史库，随时都能提交变更到本地，想回退就回退，并不会影响远程服务器，开发结束后，push到远程服务器即可。
{% endnote %}
{% note info %}
- 随地进行项目开发

  集中式版本控制系统最怕的就是断网，要正常工作，就得呆在公司或者在家使用公司内部的vpn。不要忘记，CVCS不提交代码到远程服务器，就无法进行版本控制。

  使用GIT后，一切都迎刃而解。

  假设现在有一个新项目，由我，小绿，大绿一起开发，我将项目主体结构搭建完毕后，push到远程服务器。小绿，大绿从远程服务器pull下代码，这时我们三人都拥有了仓库的一个快照。

  然后这次需求要开发A,B,C三个模块，我负责A，小绿负责B，大绿负责C，分配好任务后，大家就可以和远程服务器说拜拜，从此各奔东西，每个人的电脑都有自己的版本控制，想在哪写代码就在哪写代码，完成之后，大家一起聚个会，将代码push到远程服务器即可，如果三个模块有交叉的点，解决一下冲突即可。

惊喜不惊喜？意外不意外?GIT IS THE GOD!

{% endnote %}

## GIT存储数据的方式

其他版本控制系统，存储的是**每个文件与初始版本的差异**，注意！存的是差异，而不是当前文件。

GIT更像是一个小型的文件系统，每次提交更新时，都会对当时的全部文件制作一个快照并保存这个快照的索引。如果文件没有发生变动，Git 不再重新存储该文件，而是只保留一个链接指向之前存储的文件。

GIT所有的数据在存储前，都会进行校验和计算，随后以**校验和**来引用对应的数据。

GIT的校验和机制采用的**SHA-1**散列，GIT通过信息的散列值来存储信息，而不是文件名。

> 快照，可以近似理解为备份，但绝不是复制粘贴那么简单，快照能用来恢复原来的状态。
>
> 这里也表明了GIT的速度为什么快，当你要查看某个版本时，由于其他版本控制系统存储的是与初始版本的差异，因此在加载之前一定会有一个合并的操作，而GIT不需要，直接加载快照即可。

GIT基本上所有的操作都是像数据库中添加数据，因此很难发生数据丢失的惨况。

## GIT的三大状态【重点】

GIT中文件的状态有以下三种：

- 已提交(Committed)

  表示数据已经被安全地存入**本地**数据库中。

- 已修改(modified)

  表示文件发生了改动，但未提交到数据库。

- 已暂存(staged)

  表示对发生改动的文件做好了标识，并将其加入**下一次**要提交的快照中。

因此GIT项目中，三个主要的区域为：

- GIT目录

  保存项目元数据和对象数据库。

- 工作目录

  是项目某个版本的单次检出，这些文件从GIT目录下的压缩数据库内被提取出，放到磁盘上以供使用和修改。

- 暂存区

  是一个文件，一般位于GIT目录中，保存了下次要提交内容的相关信息。

GIT基本工作流如下：    

```sequence
workingDir->staging area: stage files
staging area->git directory(repository): commit
git directory(repository)->workingDir: check out
```
```flow
```